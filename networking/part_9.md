## Протокол HTTP

Полный стандарт можно почитать тут: [RFC-2616](https://datatracker.ietf.org/doc/html/rfc2616)

*HTTP 1* - первая версия. Вышла в 1996 году  
*HTTP 1.1* - расширение первой версии (1997г). Содержит кэширование, keep-alive, аутентификацию  
*HTTP 2* - современная версия (2015г)

**HTTP** (HyperTextTransfer Protocol) - протокол прикладного уровня, описывающий взаимодействие между двумя
компьютерами, построенное на базе сообщений запрос (request) и ответ (response).

Каждое сообщение состоит из трех частей:

- Старовая строка обязательна: _METHOD URI HTTP/VERSION_
- Заголовок (HEADER) - набор пар имя-значение
- Тело сообщения (BODY) - передаваемые данные

**HTTPS** (HyperTextTransfer Protocol Secure) - расширение протокола HTTP, подерживающее шифрование посредством
протоколов SSL и TLS.

HTTP/HTTPs используют протокол транспортного уровня
HTTP использует порт 80, HTTPS - 443

**URL** - uniform resource locator - уникальный адрес веб-страницы.

### Типы HTTP-запросов

Характеристики:

- безопасность - метод считается безопасным, когда вызов не изменяет состояние данных
- идемпотентность - когда получается один и тот же ответ, сколько бы раз не вызвался ресурс

| Method  | Значение                                                                                             |
|---------|------------------------------------------------------------------------------------------------------|
| GET     | извелечение информции                                                                                |
| HEAD    | запрашивает ресурс так же, как и метод GET, но без тела ответа                                       |
| POST    | создание ресурсов                                                                                    |
| PUT     | обновление ресурсов                                                                                  |
| PATCH   | частичное обновление ресурсов                                                                        |
| DELETE  | удаление ресурсов                                                                                    |
| OPTIONS | используется для описания параметров соединения с целевым ресурсом                                   |
| TRACE   | выполняет проверку обратной связи по пути к целевому ресурсу, предоставляя полезный механизм отладки |
| CONNECT | запускает двустороннюю связь с запрошенным ресурсом                                                  |

|                           | GET | HEAD | POST | PUT | PATCH | DELETE | OPTIONS | TRACE | CONNECT |
|---------------------------|-----|------|------|-----|-------|--------|---------|-------|---------|
| Запрос имеет тело         | Нет | Нет  | Да   | Да  | Да    | Может  | Нет     | Нет   | Нет     |
| Успешный ответ имеет тело | Да  | Нет  | Да   | Нет | Да    | Может  | Да      | Нет   | Да      |
| Безопасный                | Да  | Да   | Нет  | Нет | Нет   | Нет    | Да      | Нет   | Нет     |
| Идемпотентный             | Да  | Да   | Нет  | Да  | Нет   | Да     | Да      | Да    | Нет     |
| Кэшируемый                | Да  | Да   | Да*  | Нет | Нет   | Нет    | Нет     | Нет   | Нет     |
| Допускается в HTML-формах | Да  | Нет  | Да   | Нет | Нет   | Нет    | Нет     | Нет   | Нет     |  

\* - если включена информация о свежести сообщения

### Статусы HTTP

_1XX_ - информация
_2XX_ - успешное выполнение
_3XX_ - перенаправление (301 - постоянное перемещение, 307 - временное)
_4XX_ - ошибка на стороне клиента (403 - доступ запрещен, 404 - страница не найдена)
_5XX_ - ошибка на стороне сервера (500 - внутренняя ошибка)

### Заголовки

***Connection: keep-alive***

* Без

Устанавливается TCP-соединение. Далее происходит GET запрос на получение страницы и в ответ получает код страницы.
Далее происходит разрыв соединения. Если необходим файл со стилями, тогда заново устанавливается TCP соединение и
отправляется GET запрос на получение файла со стилями. Потом соединение разрывается.

* C (в > HTTP 1.1 использовать не обязательно, подставляется автоматически браузером):

1. Соединение устанавливается один раз.
2. Процедура троекратного рукопожатия происходит один раз
3. Нет необходимости начинать передачу данных с маленьким размером окна TCP (медленный старт).

***Кэширование***

Expires - Показывает до какого времени можно хранить ресурс в кэше. Если заголовок не установлен, то браузер использует
некоторые
эвристики. Например, *Last-Modified*. Если страница долго не менялась, то можно загрузить ее из кэша.

Протокол HTTP содержит механизм опроса страницы на изменение. Клиент отправляет запрос Conditional GET к серверу,
и если страница не изменилась (ответ _304 Not Modified_), то клиент берет ее из кэша. Сравнение происходит по заголовку
*Last-Modified*.

В HTTP 1.1 появился ETag _(entity tag)_ - код, которые генерируется на основе содержимого ресурса. Используется
заголовок
_If-None-Match_.

_Cache-Control_ - гибкое управление кэшем.

| Значение | Описание                                                        |
|----------|-----------------------------------------------------------------|
| no-store | Ресурс нельзя сохранять в кэш                                   |
| no-cache | Ресурс сохранять можно, но необходимо выполнить Conditional GET |
| public   | Информация доступна всем. Можно кэшировать                      |
| private  | Страница может быть сохранена в частном кэше                    |
| max-age  | Время хранения в sec                                            |

