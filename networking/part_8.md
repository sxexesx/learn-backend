## Прикладной уровень

Необходим для взаимодействия между собой сетевых приложений. Сетевое приложение использует протокол для того, чтобы получить какую-то полезную информацию по сети. Часто приложения используют несколько протоколов.

**Сеансовый уровень.**
*Сеанс* - набор связанных между собой сетевых взаимодействий, направленных на решение одной задачи, например загрузка Web-страницы.

**Уровень представления.**
Для понимания, что это за уровень. Можно представить онлайн звонок, который будет трансформировать китайский язык источника в русский язык потребителя. Преобразованием языка как раз и будет заниматься уровень представления. Еще один пример - защита данных (шифрование TLS/SSL).

### DNS 
_**DNS** (domain name system)_ - позволяет преобразовать имена компьютеров в IP адреса и наоборот. 

Плюсы:
- возможность менять инфраструктуру скрытую за именем
- возможность обслуживать один адрес несколькими хостами, в т.ч. и IPv6

До того, как придумали DNS имена компьютеров хранили в текстовом файле _/etc/hosts_

Особенности:
1. Децентрализована - нет одного компьютера на котором храняться все имена хостов
2. Названия компьютеров деляться на отдельные части - домены. За отдельные домены отвечают отдельные организации.
3. Дублирование серверов DNS позволяет системе быть надежной.

![alt text](src2/img16.png)

Каждая доменная зона содержит записи всех поддоменых зон. Например, зона ru - яндекс, com - cisco, google. Доменная зона является некоторым аналогом файла /etc/hosts.

Также возможно делигирование доменом верхнего уровня управление сервером доменом нижнего уровня. Например уровень yandex делигирует управление taxi другому нижележащему домену.

### Инфраструктура DNS
![alt text](src2/img17.png)

Распределением доменных имен занимаются регистраторы. Корневой регистратор - ICANN

### Протокол DNS

**Схема работы:**
Отправляется запрос на корневой домен для определения IP адреса maps.yandex.ru. Корневой сервер говорит, что не знает адреса и делегирует определение адреса низлежащему домену _ru_, который в свою очередь делегирует задачу домену _yandex.ru_.

Существуют 2 режима работы:
- итеративный - если сервер отвечает за одну доменную зону, то он возвращает ответ, если нет, то возвращает адрес другого домена, у которого есть более точная информация.

- рекурсивный - DNS сервер сам отправляет запросы всем DNS-серверам, потом результирующий ответ отправляет сам

В DNS есть два типа ответов:
1. Авторитетный (authoritative) - ответ получен от сервера, ответственного за доменную зону
2. Не авторитетный (non authoritative) - ответ от сервера, который не обслуживает доменную зону. Обычно берется из кэша

Протокол DNS работает по модели _клиент-сервер_. DNS использует протокол UDP. Работает с 53м портом.

Пакет DNS:
![alt text](src2/img18.png)

_Идентификатор_ - любое целое число (одинаковое в запросе и ответе)
_Флаги:_
    - QR - запрос/ответ
    - OPCODE - тип запроса
    - AA - авторитетный ответ или нет
    - TC - пакет обрезан или нет
    - RD - запрос на рекурсивный режим
    - RA - рекурсивный режим доступен
    - Z - зарезервирован
    - RCODE (0 - успешно, другие - произошла ошибка)
Кол-во запоросов, ответов, от авторитетных серверов, дополнительных ответов
_Запрос DNS_ -  доменное имя компьютера, для которого хотим узнать адрес
_Ответы DNS_ - IP адреса искомого компьютера
_Авторитетные серверы_ - IP адреса доменных зон

**Запрос DNS:**
Имя + Тип записи + Класс записи (сейчас 1 IN, интернет)

**Ответ DNS:**
Имя + Тип записи + Класс записи + TTL(сколько храниться в кэш) + Длина данных + Данные
|                |
|----------------|
|www.yandex.ru   |
|1 (A запись)    |
|1 (IN, Интернет)|
|90 сек          |
|4               |
|77.88.55.66     |

#### Типы записей DNS

_Тип записи_ - для чего запись предназначена
_Класс записи_ - в каких сетях используется (сейчас только интернет)

A - IPv4  
AAAA - IPv6  
CNAME - Canonical Name Record - определяет псевдоним (alias) для доменного имени  
MX - Mail eXchange - адреса почтового сервера  
SRV - для указания порта  
NS - Name Server - указывает адреса DNS-серверов, отвечающих за зону.   

Записи NS задаются на домене более высокого уровня. например ru. 
PTR - доменное имя для адреса

### Протокол SMTP

Simple Mail Transfer Protocol - простой протокол передачи почты. Создан в 1982 году. Расширенная версия
(ESMTP) вышла в 2008 г.





### Протокол POP3
### Протокол IMAP
### Протокол FTP